<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç™»å½• - æ¸¸æˆé“å…·äº¤æ˜“å¹³å°</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container" id="app">

        <!-- é¡¶éƒ¨å¯¼èˆª -->
        <header class="header">
            <div class="header-content">
                <div class="logo">
                    <span class="logo-icon">ğŸ’</span>
                    <span class="logo-text">ç™»å½•</span>
                </div>
                <button class="theme-toggle-btn" onclick="toggleTheme()">ğŸŒ“</button>
            </div>
        </header>

        <!-- ç™»å½•è¡¨å• -->
        <div class="auth-container">
            <div class="auth-card">
                <h2 class="auth-title">æ¬¢è¿å›æ¥</h2>
                <p class="auth-subtitle">ç™»å½•æ‚¨çš„è´¦æˆ·ç»§ç»­äº¤æ˜“</p>

                <div class="auth-form">
                    <div class="form-group">
                        <label>è´¦å·</label>
                        <input type="text"
                               v-model="username"
                               placeholder="è¯·è¾“å…¥è´¦å·"
                               required>
                    </div>

                    <div class="form-group">
                        <label>å¯†ç </label>
                        <input type="password"
                               v-model="password"
                               placeholder="è¯·è¾“å…¥å¯†ç "
                               required>
                    </div>

                    <button type="button" class="btn btn-primary auth-submit" v-on:click="login">
                        ç™»å½•
                    </button>
                </div>

                <div class="auth-footer">
                    <span>è¿˜æ²¡æœ‰è´¦æˆ·ï¼Ÿ</span>
                    <a href="register.html" class="link-text">ç«‹å³æ³¨å†Œ</a>
                </div>
            </div>
        </div>
    </div>

    <script src="js/tinyVue.js"></script>
    <script src="js/common.js"></script>
    <!-- ä¸»é¢˜åˆ‡æ¢ + ç™»å½•é€»è¾‘ -->
    <script>

        // === ä½¿ç”¨ tinyVue åˆ›å»ºé¡µé¢æ¨¡å‹ ===
        const vm = tinyVue({
            el: "#app",
            data: {
                username: "",
                password: "",
                remember: false
            }
        });

        // ç™»å½•
        vm.login = async function () {
            const res = await fetch("/api/auth/login", {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({
                    login_name: vm.username,
                    login_pwd: vm.password
                })
            });

            const data = await res.json();

            if (data.code !== 0) {
                alert(data.msg);
                return;
            }
            localStorage.setItem("token", data.token);
            alert("ç™»å½•æˆåŠŸï¼");
            location.href = "profile.html";
        };

    </script>

</body>
</html>
