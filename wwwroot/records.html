<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å……å€¼æç°è®°å½• - GameTrade</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div id="app">

        <!-- é¡¶éƒ¨å¯¼èˆª -->
        <header class="header">
            <div class="header-content">
                <a href="profile.html" class="back-btn">â†</a>
                <h1 class="header-title">å……å€¼æç°è®°å½•</h1>
                <button class="theme-toggle-btn" onclick="toggleTheme()">ğŸŒ“</button>
            </div>
        </header>

        <main class="main-content">
            <div class="records-container">

                <!-- tabs -->
                <div class="tabs-container">
                    <div class="tabs">
                        <button class="tab-btn"
                                :class="{active: tab==='withdraw'}"
                                v-on:click="tab='withdraw'">
                            æç°è®°å½•
                        </button>

                        <button class="tab-btn"
                                :class="{active: tab==='recharge'}"
                                v-on:click="tab='recharge'">
                            å……å€¼è®°å½•
                        </button>
                    </div>
                </div>

                <!-- ====== æç°è®°å½• ====== -->
                <div class="tab-content" v-if="tab==='withdraw'">
                    <div class="records-list">

                        <!-- æ— æ•°æ® -->
                        <div class="no-data" v-if="withdrawLogs.length===0">
                            æš‚æ— æç°è®°å½•
                        </div>

                        <!-- åˆ—è¡¨ -->
                        <div class="record-item" v-for="item in withdrawLogs">
                            <div class="record-info">
                                <div class="record-title">
                                    {{ item.pay_channel }} ğŸ’
                                </div>
                                <div class="record-meta">
                                    {{ item.order_no }}
                                </div>
                                <div class="record-time">
                                    {{ item.create_time }}
                                </div>
                            </div>

                            <div class="record-right">
                                <div class="record-amount">Â¥ -{{ item.amount }}</div>
                                <div class="record-status status-pending">
                                    {{ getStatus(item.status) }}
                                </div>

                            </div>
                        </div>

                    </div>
                </div>

                <!-- ====== å……å€¼è®°å½• ====== -->
                <div class="tab-content" v-if="tab==='recharge'">
                    <div class="records-list">

                        <div class="no-data" v-if="rechargeLogs.length===0">
                            æš‚æ— å……å€¼è®°å½•
                        </div>

                        <div class="record-item" v-for="item in rechargeLogs">
                            <div class="record-info">
                                <div class="record-title">{{ item.pay_channel }} ğŸ’</div>
                                <div class="record-meta">{{ item.order_no }}</div>
                                <div class="record-time">{{ item.create_time }}</div>
                            </div>

                            <div class="record-right">
                                <div class="record-amount">Â¥ +{{ item.amount }}</div>
                                <div class="record-status status-completed">å·²å®Œæˆ</div>
                            </div>
                        </div>

                    </div>
                </div>

            </div>
        </main>

        <!-- åº•éƒ¨å¯¼èˆª -->
        <nav class="bottom-nav">
            <a href="index.html" class="nav-item">
                <span class="nav-icon">ğŸ </span>
                <span class="nav-label">é¦–é¡µ</span>
            </a>
            <a href="publish.html" class="nav-item">
                <span class="nav-icon">â•</span>
                <span class="nav-label">å‘å¸ƒ</span>
            </a>
            <a href="profile.html" class="nav-item active">
                <span class="nav-icon">ğŸ‘¤</span>
                <span class="nav-label">æˆ‘çš„</span>
            </a>
        </nav>

    </div>

    <script src="js/tinyVue.js"></script>
    <script src="js/common.js"></script>
    <script>
        const vm = tinyVue({
            el: "#app",
            data: {
                tab: "withdraw",

                rechargeLogs: [],
                withdrawLogs: []
            },
            methods: {
                getStatus(status) {
                    switch (status) {
                        case 0: return "å¾…å¤„ç†";
                        case 1: return "å¤„ç†ä¸­";
                        case 2: return "å·²å®Œæˆ";
                        case 3: return "æç°å¤±è´¥";
                    }
                    return "æœªçŸ¥çŠ¶æ€";
                }
            }
        });
        async function loadData() {

            // === è·å–æç°è®°å½• ===
            const wd = await api("/api/finance/withdraw-logs", "POST");
            if (wd) vm.withdrawLogs = wd.data;

            // === è·å–å……å€¼è®°å½• ===
            const rc = await api("/api/finance/recharge-logs", "POST");
            if (rc) vm.rechargeLogs = rc.data;
        }
        loadData();
    </script>

</body>
</html>
